/*!CK:1541745972!*//*1380168684,178543391*/

if (self.CavalryLogger) { CavalryLogger.start_js(["nscUq"]); }

__d("WindowComm",["URI"],function(a,b,c,d,e,f){var g=b('URI'),h={_callbacks:{},makeHandler:function(i,j){j=j||'opener';var k='f'+(Math.random()*(1<<30)).toString(16).replace('.','');h._callbacks[k]=i;return new g('/connect/window_comm.php').setQueryData({_id:k,_relation:j}).getQualifiedURI().toString();},_recv:function(i){var j=new g(i).getQueryData();h._callbacks[j._id](j);}};e.exports=h;a.WindowComm=h;});
__d("EntstreamCollapsedUFIActions",["PopupWindow","React","TrackingNodes","URI","WindowComm","cx","tx"],function(a,b,c,d,e,f){var g=b('PopupWindow'),h=b('React'),i=b('TrackingNodes'),j=b('URI'),k=b('WindowComm'),l=b('cx'),m=b('tx'),n=h.createClass({displayName:'EntstreamCollapsedUFIActions',getLikeButton:function(){return this.refs.likeButton.getDOMNode();},getLikeIcon:function(){return this.refs.likeIcon.getDOMNode();},render:function(){var o;if(this.props.shareHref!==null){var p=i.getTrackingInfo(i.types.SHARE_LINK),q=j(this.props.shareHref),r=[h.DOM.i({className:"_6k1 _528f"}),"Share"];if(q.getPath().indexOf('/ajax')===0){o=h.DOM.a({ajaxify:this.props.shareHref,className:"_6j_ _5cix",'data-ft':p,href:"#",rel:"dialog",title:"Share this item"},r);}else{var s=function(){if(this.props.isPluginPublicUser){var ea=k.makeHandler(function(fa){window.location.reload();});q.addQueryData({next:ea});}g.open(q.toString(),480,600);return false;}.bind(this);o=h.DOM.a({className:"_6j_ _5cix",'data-ft':p,href:this.props.shareHref,onClick:s,target:"_blank",title:"Share this item"},r);}}var t;if(this.props.canComment){var u="_6k4 _528f",v=[h.DOM.i({className:u}),"Comment"],w="_6k2 _5cix",x=i.getTrackingInfo(i.types.COMMENT_LINK);if(this.props.storyHref){t=h.DOM.a({className:w,'data-ft':x,href:this.props.storyHref,target:"_blank",title:"Write a comment..."},v);}else t=h.DOM.a({className:w,'data-ft':x,href:"#",onClick:this.props.onCommentClick,title:"Write a comment..."},v);}var y,z=this.props.oldStyle&&this.props.hasViewerLiked?"Unlike":"Like",aa=[h.DOM.i({className:"_6k7 _528f",ref:"likeIcon"}),z,h.DOM.div({className:"_55k4"})];if(this.props.canLike){var ba=((this.props.hasViewerLiked?"_6k5":'')+(' '+"_6k6")+(' '+"_5cix")),ca=i.getTrackingInfo(this.props.hasViewerLiked?i.types.UNLIKE_LINK:i.types.LIKE_LINK),da=this.props.hasViewerLiked?"Unlike this":"Like this";if(!this.props.isPluginPublicUser){if(this.props.storyHref&&this.props.likePopup){y=h.DOM.a({className:ba,'data-ft':ca,href:this.props.storyHref,target:"_blank",ref:"likeButton",title:da},aa);}else y=h.DOM.a({className:ba,'data-ft':ca,href:"#",onClick:this.props.onLike,onMouseDown:this.props.onLikeMouseDown,ref:"likeButton",title:da},aa);}else y=h.DOM.a({className:ba,'data-ft':ca,href:this.props.storyHref,ref:"likeButton",target:"_blank",title:da},aa);}return (h.DOM.div({className:"_5ciy"},y,t,o));}});e.exports=n;});
__d("EntstreamCollapsedUFISentence",["Bootloader","NumberFormat","ProfileBrowserLink","ProfileBrowserTypes","React","URI","cx","tx"],function(a,b,c,d,e,f){var g=b('Bootloader'),h=b('NumberFormat'),i=b('ProfileBrowserLink'),j=b('ProfileBrowserTypes'),k=b('React'),l=b('URI'),m=b('cx'),n=b('tx'),o=k.createClass({displayName:'EntstreamCollapsedUFISentence',_showShareDialog:function(event){event=event.nativeEvent;if(event.isDefaultRequested())return;g.loadModules(['EntstreamShareOverlay'],function(p){p.display(this.props.feedback.targetfbid,this._getShareString());}.bind(this));event.prevent();},_getShareString:function(){var p=this.props.feedback.sharecount,q=this.props.numberDelimiter||',';if(p===1){return "1 Share";}else if(p>1){var r=h.formatIntegerWithDelimiter(p,q);return n._("{count} Shares",{count:r});}},render:function(){var p=this.props.feedback,q=p.likecount,r=this.props.commentCount,s=p.sharecount,t=p.seencount,u=this.props.hasAttachedUFIExpanded,v=this.props.numberDelimiter||',';if(u){q=0;r=0;}if(!q&&!r&&!s&&!t)return k.DOM.span(null);var w;if(q===1){w="1 Like";}else if(q>1){var x=h.formatIntegerWithDelimiter(q,v);w=n._("{count} Likes",{count:x});}var y;if(r===1){y="1 Comment";}else if(r>1){var z=h.formatIntegerWithDelimiter(r,v);y=n._("{count} Comments",{count:z});}var aa=this._getShareString(),ba,ca,da;if(w){ca=new l('/ajax/like/tooltip.php').setQueryData({comment_fbid:p.targetfbid,comment_from:p.actorforpost,seen_user_fbids:true});var ea=((y||aa?"prm":''));ba=j.LIKES;da={id:p.targetfbid};var fa=i.constructDialogURI(ba,da).toString();if(this.props.storyHref){w=null;}else w=k.DOM.a({ajaxify:fa,className:ea,href:i.constructPageURI(ba,da).toString(),'data-hover':"tooltip",'data-tooltip-alignh':"center",'data-tooltip-uri':ca.toString(),rel:"dialog"},w);}var ga;if(t>0){ba=j.GROUP_MESSAGE_VIEWERS;da={id:p.targetfbid};var ha=i.constructDialogURI(ba,da),ia=i.constructPageURI(ba,da);ca=new l('/ajax/ufi/seen_tooltip.php').setQueryData({ft_ent_identifier:p.entidentifier,displayed_count:t});var ja=h.formatIntegerWithDelimiter(t,v);if(p.seenbyall){ga="Seen by everyone";}else ga=ja==1?"Seen by 1":n._("Seen by {count}",{count:ja});ga=k.DOM.a({ajaxify:ha.toString(),'data-hover':"tooltip",'data-tooltip-alignh':"center",'data-tooltip-uri':ca.toString(),href:ia.toString(),rel:"dialog",tabindex:"-1"},ga);}if(y){var ka=((aa?"prm":''));if(this.props.storyHref){y=k.DOM.a({className:ka,href:this.props.storyHref,target:"_blank"},y);}else y=k.DOM.a({className:ka,href:"#",onClick:this.props.onCommentClick},y);}if(aa){var la=new l('/shares/view').setSubdomain('www').setQueryData({id:p.targetfbid});if(this.props.storyHref){aa=k.DOM.a({href:la.toString(),target:"_blank"},aa);}else aa=k.DOM.a({href:la.toString(),onClick:this._showShareDialog,rel:"ignore"},aa);}return (k.DOM.span({className:"_5civ"},w,y,aa,ga));}});e.exports=o;});
__d("EntstreamCollapsedUFI",["Event","Animation","BrowserSupport","CSS","DOM","Ease","EntstreamCollapsedUFIActions","EntstreamCollapsedUFISentence","PrivacyConstants","React","TrackingNodes","Vector","cx","queryThenMutateDOM"],function(a,b,c,d,e,f){var g=b('Event'),h=b('Animation'),i=b('BrowserSupport'),j=b('CSS'),k=b('DOM'),l=b('Ease'),m=b('EntstreamCollapsedUFIActions'),n=b('EntstreamCollapsedUFISentence'),o=b('PrivacyConstants'),p=b('React'),q=b('TrackingNodes'),r=b('Vector'),s=b('cx'),t=b('queryThenMutateDOM'),u=5,v=p.createClass({displayName:'EntstreamCollapsedUFI',_animate:function(w,x,y,z){if(!i.hasCSSTransforms())return;var aa=this.refs.icons.getLikeIcon();this._animation&&this._animation.stop();this._animation=new h(aa).from('scaleX',w).from('scaleY',w).to('scaleX',x).to('scaleY',x).duration(y);z&&this._animation.ease(z);this._animation.go();},bounceLike:function(){this._animate(1.35,1,750,l.bounceOut);},shrinkLike:function(){this._animate(1,.85,150);this._mouseUpListener=g.listen(document.body,'mouseup',this._onMouseUp);},_onMouseUp:function(event){this._mouseUpListener.remove();if(!k.contains(this.refs.icons.getLikeButton(),event.getTarget()))this._animate(.85,1,150);},render:function(){var w=this.props.feedback,x=q.getTrackingInfo(q.types.BLINGBOX),y=w.viewerid===(o.PRIVACY_PROFILE_VIEWAS_EVERYONE_USER).toString();return (p.DOM.div({className:"clearfix"},p.DOM.div({ref:"footer"}),m({isPluginPublicUser:y,canLike:w.viewercanlike,canComment:w.cancomment,hasViewerLiked:w.hasviewerliked,likePopup:this.props.likePopup,oldStyle:this.props.oldStyle,onCommentClick:this.props.onCommentClick,onLike:this.props.onLike,onLikeMouseDown:this.props.onLikeMouseDown,ref:"icons",shareHref:this.props.shareHref,storyHref:this.props.storyHref}),p.DOM.div({className:"_6j-",'data-ft':x,ref:"sentence"},n({commentCount:this.props.commentCount,feedback:w,hasAttachedUFIExpanded:this.props.hasAttachedUFIExpanded,numberDelimiter:this.props.numberDelimiter,onCommentClick:this.props.onCommentClick,storyHref:this.props.storyHref}))));},componentDidMount:function(w){var x=this.refs.icons.getDOMNode(),y=this.refs.sentence.getDOMNode(),z,aa,ba;t(function(){z=r.getElementDimensions(w).x;aa=r.getElementDimensions(x).x;ba=r.getElementDimensions(y).x;},function(){if(aa+ba>z-u)j.addClass(w,"_5ext");});}});e.exports=v;});
__d("EntstreamCollapsedUFIController",["Bootloader","CommentPrelude","CSS","DOM","EntstreamCollapsedUFI","React","ReactMount","UFICentralUpdates","UFIComments","UFIConstants","UFIFeedbackTargets","UFIUserActions","UIPagelet","copyProperties","csx","cx","onEnclosingPageletDestroy"],function(a,b,c,d,e,f){var g=b('Bootloader'),h=b('CommentPrelude'),i=b('CSS'),j=b('DOM'),k=b('EntstreamCollapsedUFI'),l=b('React'),m=b('ReactMount'),n=b('UFICentralUpdates'),o=b('UFIComments'),p=b('UFIConstants'),q=b('UFIFeedbackTargets'),r=b('UFIUserActions'),s=b('UIPagelet'),t=b('copyProperties'),u=b('csx'),v=b('cx'),w=b('onEnclosingPageletDestroy'),x=p.UFIPayloadSourceType;function y(z,aa,ba){this._root=z;this._id=ba.ftentidentifier;this._contextArgs=ba;this._ufiVisible=ba.hasattachedufiexpanded;this._ufiRendered=!ba.pageletdata;this._updateSubscription=n.subscribe('feedback-updated',function(ca,da){if(da.payloadSource!=x.INITIAL_SERVER&&this._id in da.updates)this.render();}.bind(this));n.handleUpdate(p.UFIPayloadSourceType.COLLAPSED_UFI,aa);g.loadModules(['ScrollAwareDOM'],function(ca){m.scrollMonitor=ca.monitor;});w(this._root,this.destroy.bind(this));}t(y.prototype,{_onLike:function(event){this._feedbackSubscription=q.getFeedbackTarget(this._id,function(z){r.changeLike(this._id,!z.hasviewerliked,{source:this._contextArgs.source,target:event.target,rootid:j.getID(this._root)});}.bind(this));this._ufi.bounceLike();if(!this._ufiVisible&&!this._ufiRendered){this._ufiVisible=true;i.removeClass(this._root.parentNode,'collapsed_comments');this._loadAndRenderUFIPagelet();}event.preventDefault();},_onLikeMouseDown:function(event){this._ufi.shrinkLike();event.preventDefault();},_onCommentClick:function(event){if(!this._ufiVisible){this._ufiVisible=true;i.addClass(this._root,"_6ka");if(!this._ufiRendered)this._loadAndRenderUFIPagelet();}h.click(this._root,this._ufiRendered);event.preventDefault();},_loadAndRenderUFIPagelet:function(){s.loadFromEndpoint('EntstreamUFIPagelet',j.find(this._root.parentNode,"._5kuo"),this._contextArgs.pageletdata,{displayCallback:this._onUFIPageletLoadComplete.bind(this)});},_onUFIPageletLoadComplete:function(z){z();h.expand.curry(this._root).defer();this._ufiRendered=true;},render:function(){this._feedbackSubscription=q.getFeedbackTarget(this._id,function(z){var aa=k({commentCount:o.getCommentCount(this._id),feedback:z,hasAttachedUFIExpanded:this._contextArgs.hasattachedufiexpanded,likePopup:this._contextArgs.likepopup,numberDelimiter:this._contextArgs.numberdelimiter,oldStyle:this._contextArgs.oldstyle,onCommentClick:this._onCommentClick.bind(this),onLike:this._onLike.bind(this),onLikeMouseDown:this._onLikeMouseDown.bind(this),shareHref:this._contextArgs.sharehref,storyHref:this._contextArgs.storyhref});l.renderComponent(aa,this._root);this._ufi=this._ufi||aa;}.bind(this));},destroy:function(){if(this._feedbackSubscription){q.unsubscribe(this._feedbackSubscription);this._feedbackSubscription=null;}this._updateSubscription.unsubscribe();this._updateSubscription=null;l.unmountComponentAtNode(this._root);this._root=null;this._id=null;this._contextArgs=null;this._ufiVisible=null;}});e.exports=y;});
__d("LitestandEllipsis",["concatMap","createArrayFrom","DOM","Vector"],function(a,b,c,d,e,f){var g=b('concatMap'),h=b('createArrayFrom'),i=b('DOM'),j=b('Vector'),k,l={add:function(o,p){var q=i.scry(o,'br');q.forEach(i.remove);var r=j.getElementDimensions(o).y;if(r<=p)return o;var s,t='...',u=n(o),v=u.length-1,w=i.getText(u[v]);while(v>=0&&r>p){s=Math.max(w.lastIndexOf(' '),w.lastIndexOf('\n'));if(s===-1)s=w.length-t.length-1;if(s<=0){m(u[v],'');v--;w=i.getText(u[v]);}else{w=w.substr(0,s).trim()+t;m(u[v],w);}r=j.getElementDimensions(o).y;}}};function m(o,p){k=k||(o.textContent!=null?'textContent':'innerText');o[k]=p;}function n(o){if(i.isTextNode(o))return o;return g(n,h(o.childNodes));}e.exports=l;});
__d("LitestandShareAttachment",["CSS","DOM","LitestandEllipsis","Parent","csx","cx","queryThenMutateDOM"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DOM'),i=b('LitestandEllipsis'),j=b('Parent'),k=b('csx'),l=b('cx'),m=b('queryThenMutateDOM'),n=16,o=22,p=5,q=10,r={init:function(t){var u,v,w,x,y,z;m(function(){x=j.byClass(t,"_31r");if(x&&!g.hasClass(x,"_31q"))g.addClass(x,"_5fxa");v=h.find(t,"._6m3");u=h.find(t,"._6m6");w=h.find(t,"._59tj");y=h.scry(t,"._6m7")[0];z=s(v,u,w);},function(){if(!z){y&&g.hide(y);i.add(u,p*o);}else if(y&&z){g.show(y);i.add(y,z*n);}x&&g.removeClass(x,"_5fxa");});}};function s(t,u,v){var w=Math.round(u.scrollHeight/o);if(w>=p)return 0;var x=t.offsetHeight-u.scrollHeight-v.scrollHeight-q;return Math.floor(x/n);}e.exports=r;});
/*!CK:1756242363!*//*1380153025,180780601*/

if (self.CavalryLogger) { CavalryLogger.start_js(["a7RDT"]); }

__d("SubscriptionLevels",[],function(a,b,c,d,e,f){var g={ALL:'162318810514679',DEFAULT:'271670892858696',TOP:'266156873403755'};e.exports=g;});
__d("EditSubscriptions",["Event","function-extensions","Arbiter","AsyncRequest","CSS","DOM","MenuDeprecated","Parent","SubscriptionLevels","FeedBlacklistButton","arrayContains","cx","ge"],function(a,b,c,d,e,f){var g=b('Event');b('function-extensions');var h=b('Arbiter'),i=b('AsyncRequest'),j=b('CSS'),k=b('DOM'),l=b('MenuDeprecated'),m=b('Parent'),n=b('SubscriptionLevels'),o=b('FeedBlacklistButton'),p=b('arrayContains'),q=b('cx'),r=b('ge'),s=45,t=[n.ALL,n.DEFAULT,n.TOP],u={},v={},w={},x={},y={},z={},aa={},ba={},ca={},da={},ea={},fa="/ajax/follow/follow_profile.php",ga="/ajax/follow/unfollow_profile.php",ha="/ajax/settings/notifications/notify_me.php",ia={},ja={},ka=null,la=false,ma={};function na(kb){return p(t,kb);}function oa(kb,lb,mb,nb){var ob=m.byClass(nb,'uiMenuItem')||m.byClass(nb,"_54ni"),pb=k.getID(kb);if(!ob||!k.contains(kb,ob)){return;}else if(j.hasClass(ob,'SubscribeMenuSubscribeCheckbox')){if(w[lb]){sa(pb,lb);}else ra(pb,lb);return false;}else if(j.hasClass(ob,'SubscribeMenuUnsubscribe')){sa(pb,lb);return false;}else if(j.hasClass(ob,'SubscribeMenuSettingsItem')){eb(kb,true);return false;}else if(j.hasClass(ob,'SubscriptionMenuGoBack')){eb(kb,false);return false;}else if(j.hasClass(ob,'SubscriptionMenuItem')){pa(kb,lb,mb,ob);return false;}else if(j.hasClass(ob,'SubscribeMenuNotifyMeCheckbox')){if(x[lb]){ib(kb,lb);}else hb(kb,lb);return false;}}function pa(kb,lb,mb,nb){if(j.hasClass(nb,'SubscriptionMenuLevel')){if(l.isItemChecked(nb))return;cb(kb,lb,va(nb),true,mb);}else if(j.hasClass(nb,'SubscriptionMenuCategory')){za(lb,nb,!l.isItemChecked(nb),true,mb);}else if(j.hasClass(nb,'SubscriptionAppStory'))bb(lb,nb,!l.isItemChecked(nb),mb);}function qa(kb){return ma[kb]?ma[kb]:0;}function ra(kb,lb){var mb={profile_id:lb};h.inform('FollowingUser',mb);h.inform(o.UNBLACKLIST,mb);new i().setURI(fa).setMethod('POST').setData({profile_id:lb,location:qa(kb)}).setErrorHandler(h.inform.curry('FollowUserFail',mb)).send();}function sa(kb,lb){var mb={profile_id:lb};h.inform('UnfollowingUser',mb);h.inform(o.BLACKLIST,mb);new i().setURI(ga).setMethod('POST').setData({profile_id:lb,location:qa(kb)}).setErrorHandler(h.inform.curry('UnfollowUserFail',mb)).send();}function ta(kb,lb,mb){var nb={profile_id:kb,level:ba[kb],custom_categories:ca[kb],location:mb};new i().setURI('/ajax/follow/manage_subscriptions.php').setData(nb).send();}function ua(kb,lb){var mb=ca[lb]||[],nb=l.getItems(kb);nb.forEach(function(ob){if(j.hasClass(ob,'SubscriptionMenuCategory')){var pb=va(ob);if(p(mb,pb)){xa(ob);}else ya(ob);}else if(j.hasClass(ob,'SubscriptionAppStory')){var qb=va(ob);if(ja[lb]&&ja[lb][qb]){xa(ob);}else ya(ob);}});cb(kb,lb,ba[lb],false);}function va(kb){var lb=k.scry(kb,'input')[0];return lb&&lb.value;}function wa(kb){return k.find(kb,'a.itemAnchor');}function xa(kb){j.addClass(kb,'checked');wa(kb).setAttribute('aria-checked',true);}function ya(kb){j.removeClass(kb,'checked');wa(kb).setAttribute('aria-checked',false);}function za(kb,lb,mb,nb,ob){if(mb){xa(lb);}else ya(lb);var pb=va(lb);if(na(pb)){mb&&ab(kb,pb);}else if(mb){if(!p(ca[kb],pb))ca[kb].push(pb);}else{var qb=ca[kb].indexOf(pb);if(qb!==-1)ca[kb].splice(qb,1);}if(nb)ta(kb,pb,ob);}function ab(kb,lb){ba[kb]=lb;h.inform('SubscriptionLevelUpdated',{profile_id:kb,level:lb});}function bb(kb,lb,mb,nb){var ob='/ajax/feed/filter_action/',pb=va(lb),qb={actor_id:kb,app_id:pb};if(mb){xa(lb);ob+='resubscribe_user_app/';qb.action='resubscribe_user_app';if(!ja[kb])ja[kb]={};ja[kb][pb]=true;}else{ya(lb);ob+='unsubscribe_user_app_checkbox/';qb.action='unsubscribe_user_app_checkbox';if(ja[kb])ja[kb][pb]=false;}new i().setURI(ob).setData(qb).send();}function cb(kb,lb,mb,nb,ob){var pb=k.scry(kb,'.SubscriptionMenuLevel'),qb=null;pb.forEach(function(rb){if(va(rb)==mb){qb=rb;}else if(l.isItemChecked(rb))za(lb,rb,false,false);});qb&&za(lb,qb,true,nb,ob);}function db(kb,lb,mb){w[lb]=mb;j.conditionClass(kb,'isUnsubscribed',!mb);var nb=k.scry(kb,'li.SubscribeMenuSubscribeCheckbox');if(nb.length!==0){var ob=nb[0];if(mb){xa(ob);}else ya(ob);}}function eb(kb,lb){j.conditionClass(kb,'subscriptionMenuOpen',lb);}function fb(kb,lb,mb){var nb=k.find(kb,".FriendListSubscriptionsMenu"),ob=k.find(nb,".uiMenuInner");if(ka!=null)ka.forEach(function(pb){ob.removeChild(pb);});mb.forEach(function(pb){ob.appendChild(pb);});ka=mb;}h.subscribe('UnfollowUser',function(kb,lb){if(da[lb.profile_id]){ab(lb.profile_id,da[lb.profile_id]);ca[lb.profile_id]=ea[lb.profile_id].slice();}});h.subscribe('UpdateSubscriptionLevel',function(kb,lb){var mb=lb.profile_id+'',nb=lb.level+'';ab(mb,nb);var ob;for(ob in u)if(u[ob]===mb){var pb=r(ob);pb&&cb(pb,mb,nb,false);}});function gb(kb,lb,mb){x[lb]=mb;var nb=z[lb]&&!la,ob=k.scry(kb,'li.SubscribeMenuNotifyMeCheckbox');if(ob.length!==0){var pb=ob[0];j.conditionShow(pb,!nb);var qb=k.scry(kb,'li.SubscribeMenuNotifyMeCheckboxSeparator');if(qb.length>0)j.conditionShow(qb[0],!nb);if(mb){xa(pb);}else ya(pb);}}function hb(kb,lb){var mb={profile_id:lb};h.inform('EnableNotifsForUser',mb);new i().setURI(ha).setMethod('POST').setData({notifier_id:lb,enable:true}).setErrorHandler(h.inform.curry('EnableNotifsForUserFail',mb)).send();}function ib(kb,lb){var mb={profile_id:lb};h.inform('DisableNotifsForUser',mb);new i().setURI(ha).setMethod('POST').setData({notifier_id:lb,enable:false}).setErrorHandler(h.inform.curry('DisableNotifsForUserFail',mb)).send();}var jb={init:function(kb,lb,mb){var nb=k.getID(kb);ma[nb]=mb;if(!u[nb])g.listen(kb,'click',function(ob){return oa(kb,u[nb],mb,ob.getTarget());});if(mb===s&&ia[lb].length)fb(kb,lb,ia[lb]);if(ba[lb])ua(kb,lb);u[nb]=lb;j.conditionClass(kb,'NonFriendSubscriptionMenu',!v[lb]);j.conditionClass(kb,'cannotSubscribe',!y[lb]);j.conditionClass(kb,'noSubscriptionLevels',z[lb]&&!aa[lb]);j.conditionClass(kb,'noSubscribeCheckbox',!v[lb]&&!z[lb]);db(kb,lb,w[lb]);gb(kb,lb,x[lb]);h.subscribe(['FollowUser','FollowingUser','UnfollowUserFail'],function(ob,pb){if(pb.profile_id==lb)db(kb,lb,true);}.bind(this));h.subscribe(['UnfollowUser','UnfollowingUser','FollowUserFail'],function(ob,pb){if(pb.profile_id==lb){h.inform('SubMenu/Reset');db(kb,lb,false);}}.bind(this));h.subscribe(['EnableNotifsForUser','DisableNotifsForUserFail'],function(ob,pb){gb(kb,lb,true);}.bind(this));h.subscribe(['DisableNotifsForUser','EnableNotifsForUserFail'],function(ob,pb){gb(kb,lb,false);}.bind(this));h.subscribe('listeditor/friend_lists_changed',function(ob,pb){if(pb.notify_state){var qb=pb.added_uid?pb.added_uid:pb.removed_uid;gb(kb,qb,pb.notify_state.is_notified);}}.bind(this));},getSubscriptions:function(kb){return {level:ba[kb],custom_categories:ca[kb]};},setSubscriptions:function(kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb,wb){ab(kb,qb+'');v[kb]=lb;w[kb]=mb;y[kb]=nb;z[kb]=ob;aa[kb]=pb;da[kb]=sb+'';ca[kb]=rb.map(String);ea[kb]=tb.map(String);ia[kb]=wb;x[kb]=ub;la=vb;}};e.exports=a.EditSubscriptions||jb;});
__d("legacy:EditSubscriptions",["SubscriptionLevels","EditSubscriptions"],function(a,b,c,d){a.SubscriptionLevels=b('SubscriptionLevels');a.EditSubscriptions=b('EditSubscriptions');},3);
__d("DynamicFriendListEducation",["Event","Arbiter","AsyncRequest","Dialog","PageTransitions","arrayContains","createArrayFrom","removeFromArray"],function(a,b,c,d,e,f){var g=b('Event'),h=b('Arbiter'),i=b('AsyncRequest'),j=b('Dialog'),k=b('PageTransitions'),l=b('arrayContains'),m=b('createArrayFrom'),n=b('removeFromArray'),o,p,q,r,s,t;function u(){q&&q.hide();r&&r.hide();}function v(y){n(p,y);u();s({accept_tag_education:true});}function w(){u();s({nux_cancel:true});}var x={init:function(y,z){o=y;p=m(z).map(String);k.registerHandler(function(){u();o=false;s=undefined;p=[];});},showDialog:function(y,z,aa){if(o&&l(p,y)){u();h.inform('DynamicFriendListEducation/dialogOpen',{uid:z,flid:y});s=aa;q=new j().setAsync(new i('/ajax/friends/lists/smart_list_education.php').setMethod('GET').setData({flid:y,uid:z}).setReadOnly(true)).setHandler(v.bind(this,y)).setCloseHandler(function(){h.inform('DynamicFriendListEducation/dialogClosed',{uid:z,flid:y});}).setCancelHandler(function(){h.inform('DynamicFriendListEducation/dialogCancel',{uid:z,flid:y});}).show();}else aa();},showContextualDialog:function(y,z,aa,ba){if(o&&l(p,y)){u();t=aa;s=ba;new i('/ajax/friends/lists/smart_list_contextual_education.php').setMethod('GET').setData({flid:y,uid:z}).setReadOnly(true).send();}else ba();},setContextualDialog:function(y,z,aa,ba){r=y;r.setContext(t);r.show();g.listen(z,'click',v.bind(this,ba));g.listen(aa,'click',w);}};e.exports=x;});
__d("FriendStatus",["function-extensions","Arbiter","AsyncRequest","SubscribeButton","arrayContains","copyProperties","createArrayFrom","eachKeyVal"],function(a,b,c,d,e,f){b('function-extensions');var g=b('Arbiter'),h=b('AsyncRequest'),i=b('SubscribeButton'),j=b('arrayContains'),k=b('copyProperties'),l=b('createArrayFrom'),m=b('eachKeyVal');function n(r,s,t){this.id=r;this.update(s,t);}k(n.prototype,{update:function(r,s){r&&(this.status=r);if(s){this.lists=l(s).map(String);this._informListChange();}},isComplete:function(){return !!this.lists;},addToList:function(r){if(this.lists&&!j(this.lists,r))this.lists.push(r);this._informListChange();},removeFromList:function(r){if(this.lists){var s=this.lists.indexOf(r);s!==-1&&this.lists.splice(s,1);}this._informListChange();},updateList:function(r,s){s?this.addToList(r):this.removeFromList(r);},_informListChange:function(){g.inform('FriendListMembershipChange',{uid:this.id,lists:this.lists});}});k(n,{ARE_FRIENDS:1,INCOMING_REQUEST:2,OUTGOING_REQUEST:3,CAN_REQUEST:4});var o={},p={};function q(r,s,t){if(!o[t.uid]){o[t.uid]=new n(t.uid,r);}else o[t.uid].update(r);g.inform('FriendRequest/change',{uid:t.uid,status:r});}g.subscribe('FriendRequest/cancel',function(r,s){s.profile_id=s.uid;s.check_enabled_follow=true;g.inform(i.UNSUBSCRIBED,s);});g.subscribe(['FriendRequest/cancel','FriendRequest/unfriend','FriendRequest/sendFail'],q.curry(n.CAN_REQUEST));g.subscribe(['FriendRequest/confirmFail'],q.curry(n.INCOMING_REQUEST));g.subscribe(['FriendRequest/cancelFail','FriendRequest/sent','FriendRequest/sending'],q.curry(n.OUTGOING_REQUEST));g.subscribe(['FriendRequest/confirm','FriendRequest/confirming'],q.curry(n.ARE_FRIENDS));k(n,{CLOSE_FRIENDS:null,ACQUAINTANCES:null,getFriend:function(r,s){if(o[r]&&o[r].isComplete()){s(o[r]);}else if(p[r]){p[r].push(s);}else{p[r]=[s];new h().setURI("/ajax/friends/status.php").setData({friend:r}).setHandler(function(t){var u=t.getPayload();n.initFriend.bind(n,r,u.status,u.lists).defer();}).send();}},initFriend:function(r,s,t){var u=o[r]||new n(r);u.update(u.status||s,u.lists||t);o[r]=u;p[r]&&p[r].forEach(function(v){v(u);});p[r]=null;},setSpecialLists:function(r){var s=n.CLOSE_FRIENDS===null;n.CLOSE_FRIENDS=r.close+'';n.ACQUAINTANCES=r.acq+'';if(s)m(o,function(t,u){u._informListChange();});}});e.exports=n;});
__d("FriendEditLists",["Arbiter","AsyncRequest","CSS","DOMQuery","DynamicFriendListEducation","EditSubscriptions","Event","FriendStatus","MenuDeprecated","Parent","ScrollableArea","SubscribeButton","URI","$","arrayContains","copyProperties","ge"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('AsyncRequest'),i=b('CSS'),j=b('DOMQuery'),k=b('DynamicFriendListEducation'),l=b('EditSubscriptions'),m=b('Event'),n=b('FriendStatus'),o=b('MenuDeprecated'),p=b('Parent'),q=b('ScrollableArea'),r=b('SubscribeButton'),s=b('URI'),t=b('$'),u=b('arrayContains'),v=b('copyProperties'),w=b('ge'),x=5,y={},z='/ajax/profile/removefriendconfirm.php',aa='/ajax/friends/requests/cancel.php',ba='/ajax/choose/',ca='/profile.php',da='/ajax/report/social.php',ea,fa,ga=null,ha={profile_browser:43,fbx_top_bar:1,hovercard:5};function ia(ta,ua,va){var wa=y[ta.id],xa=function(ya){var za={action:va?'add_list':'del_list',to_friend:wa.id,friendlists:[ua],source:ea};if(ya)v(za,ya);wa.updateList(ua,va);var ab;if(va&&ua==n.CLOSE_FRIENDS){ab=la(ta,n.ACQUAINTANCES);if(o.isItemChecked(ab)){o.toggleItem(ab);ia(ta,n.ACQUAINTANCES,false);}}else if(va&&ua==n.ACQUAINTANCES){ab=la(ta,n.CLOSE_FRIENDS);if(o.isItemChecked(ab)){o.toggleItem(ab);ia(ta,n.CLOSE_FRIENDS,false);}}var bb={flid:ua,uid:wa.id},cb=va?'FriendListHovercard/add':'FriendListHovercard/remove';g.inform(cb,bb);new h().setURI('/ajax/add_friend/action.php').setData(za).send();};if(va){k.showDialog(ua,wa.id,xa);}else xa();}function ja(ta){var ua=j.scry(ta,'input')[0];return ua&&ua.value;}function ka(ta,ua,va){var wa={uid:ua.id};new h().setURI(aa).setMethod('POST').setData({friend:ua.id}).setHandler(g.inform.bind(g,'FriendRequest/cancel',wa)).setErrorHandler(g.inform.bind(g,'FriendRequest/cancelFail',wa)).setStatusElement(va).send();}function la(ta,ua){var va=o.getItems(ta);for(var wa=0;wa<va.length;wa++)if(ja(va[wa])==ua)return va[wa];return null;}function ma(ta,ua){var va=o.getItems(ta);va.forEach(function(wa){var xa=ja(wa),ya=u(ua.lists,xa);if(o.isItemChecked(wa)!==ya)o.toggleItem(wa);});}function na(ta){var ua=o.getItems(ta),va=!i.hasClass(ta,'followButtonFlyout')&&!i.hasClass(ta,'likeButtonFlyout'),wa=[],xa=[],ya=0,za=0;ua.forEach(function(eb){if(i.hasClass(eb,'neverHide')){i.removeClass(eb,'underShowMore');ya++;}else if(o.isItemChecked(eb)){wa.push(eb);}else if(i.hasClass(eb,'neverShow')||i.hasClass(eb,'FriendListCreateTrigger')||(!va&&i.hasClass(eb,'friendOptionsOnly'))){i.addClass(eb,'underShowMore');za++;}else xa.push(eb);});var ab=x-ya,bb=wa.concat(xa),cb=za;bb.forEach(function(eb){if(i.hasClass(eb,'ShowMoreItem')){ab--;return;}if(ab){i.removeClass(eb,'underShowMore');ab--;}else{i.addClass(eb,'underShowMore');cb=true;}});i.conditionClass(ta,'hasMoreFriendListItems',cb);var db=j.scry(ta,'.FriendListMenuShowMore');db.forEach(function(eb){i.removeClass(eb,'FriendListMenuShowMore');});}function oa(ta,ua){i.conditionClass(ta,'FriendListMemorializedUser',ua);}function pa(ta,ua){i.conditionClass(ta,'FriendListCannotSuggestFriends',!ua);}function qa(ta,ua){var va=j.scry(ta,'.FriendListUnfriend')[0],wa=j.scry(ta,'.FriendListCancel')[0],xa=j.scry(ta,'.FriendListSuggestFriends')[0],ya=j.scry(ta,'.FriendListFriendship')[0],za=j.scry(ta,'.FriendListReportBlock')[0];if(wa)i.conditionShow(wa,ua.status==n.OUTGOING_REQUEST);if(va){i.conditionShow(va,ua.status==n.ARE_FRIENDS);var ab=j.find(va,'a');ab.setAttribute('ajaxify',s(z).addQueryData({uid:ua.id,unref:fa}).toString());if(!ga)ga=m.listen(ab,'click',function(bb){var cb=p.byClass(bb.getTarget(),'FriendListUnfriend');if(!cb)return;var db=s(j.find(cb,'a').getAttribute('ajaxify')).getQueryData();if(db.uid)g.inform(r.UNSUBSCRIBED,{profile_id:db.uid.toString(),check_enabled_follow:true});});}else i.conditionClass(ta,'NoFriendListActionSeparator',!wa||ua.status!=n.OUTGOING_REQUEST);if(xa)j.find(xa,'a').setAttribute('href',s(ba).addQueryData({type:'suggest_friends',newcomer:ua.id,ref:'profile_others_dropdown'}).toString());if(ya){i.conditionShow(ya,ua.status==n.ARE_FRIENDS);j.find(ya,'a').setAttribute('href',s(ca).addQueryData({and:ua.id}).toString());}if(za)j.find(za,'a').setAttribute('ajaxify',s(da).addQueryData({content_type:0,cid:ua.id,rid:ua.id}).toString());}function ra(ta,ua,va){var wa=j.scry(ta,'div.FriendListSubscriptionsMenu');if(wa.length!==0)l.init(ta,ua,va);}g.subscribe('FriendRequest/change',function(ta,ua){for(var va in y){var wa=w(va),xa=y[va];if(wa&&xa&&xa.id==ua.uid){ma(wa,xa);qa(wa,xa);na(wa);}}});o.subscribe('select',function(ta,ua){if(i.hasClass(ua.item,'ShowMoreItem')&&i.hasClass(ua.menu,'FriendListMenu')){i.addClass(ua.menu,'FriendListMenuShowMore');q.poke(ua.item);}});var sa={init:function(ta,ua,va,wa,xa,ya){ta=t(ta);ea=va;fa=ya;var za=ha[va]||45;if(!y[ta.id])o.subscribe('select',function(ab,bb){if(j.contains(ta,bb.item))if(p.byClass(bb.item,'FriendListItem')){o.toggleItem(bb.item);var cb=ja(bb.item);ia(ta,cb,o.isItemChecked(bb.item));}else if(p.byClass(bb.item,'FriendListCancel')){ka(ta,y[ta.id],bb.item);}else if(p.byClass(bb.item,'FriendListUnfriend'))g.inform('FriendEditLists/unfriend');});i.addClass(ta,'async_saving');n.getFriend(ua,function(ab){oa(ta,wa);pa(ta,xa);ma(ta,ab);qa(ta,ab);y[ta.id]=ab;na(ta);ra(ta,ua,za);i.removeClass(ta,'async_saving');}.bind(this));}};e.exports=a.FriendEditLists||sa;});
__d("FriendListFlyoutController",["Event","Arbiter","AsyncRequest","Button","ContextualLayer","CSS","DataStore","Dialog","DOM","DOMQuery","FriendEditLists","FriendStatus","Keys","Layer","LayerHideOnEscape","LayerTabIsolation","MenuDeprecated","Parent","ScrollableArea","Style","TabbableElements","UserAgent","cx","emptyFunction"],function(a,b,c,d,e,f){var g=b('Event'),h=b('Arbiter'),i=b('AsyncRequest'),j=b('Button'),k=b('ContextualLayer'),l=b('CSS'),m=b('DataStore'),n=b('Dialog'),o=b('DOM'),p=b('DOMQuery'),q=b('FriendEditLists'),r=b('FriendStatus'),s=b('Keys'),t=b('Layer'),u=b('LayerHideOnEscape'),v=b('LayerTabIsolation'),w=b('MenuDeprecated'),x=b('Parent'),y=b('ScrollableArea'),z=b('Style'),aa=b('TabbableElements'),ba=b('UserAgent'),ca=b('cx'),da=b('emptyFunction'),ea,fa,ga=null,ha=null,ia,ja,ka,la,ma,na,oa=1500,pa,qa=false,ra=['uiButtonConfirm','uiButtonSpecial',"_42gz","_42g-","_4jy2","_51tl","_4jy1"],sa={init:function(ub,vb){sa.init=da;ea=ub;ea.subscribe('mouseenter',bb);ea.subscribe('mouseleave',function(){if(!qa)pb();});ea.subscribe('hide',db);ea.enableBehavior(v);ea.enableBehavior(u);pa=vb;if(ga)o.setContent(ea.getContent(),[ga,ha]);var wb=function(yb){var zb=x.byClass(yb.getTarget(),'enableFriendListFlyout');if(zb){qa=true;if(ia!==zb){fa&&rb();ob(zb);}}else if(qa)rb();},xb=function(yb){var zb=x.byClass(yb.getTarget(),'enableFriendListFlyout');if(zb)if(ia===zb){clearTimeout(la);}else{fa&&rb();ob(zb);}};g.listen(document.documentElement,{click:wb,mouseover:xb,keydown:function(event){var yb=event.getTarget();if(event.getModifiers().any)return;if(!fa||p.isNodeOfType(yb,['input','textarea']))return;var zb=g.getKeyCode(event),ac;switch(zb){case s.UP:case s.DOWN:var bc=ab();ac=ya(bc);wa(bc[ac+(zb===s.UP?-1:1)]);return false;case s.SPACE:var cc=xa(yb);if(cc){ta(cc);event.prevent();}break;default:var dc=String.fromCharCode(zb).toLowerCase(),ec=ab();ac=ya(ec);var fc=ac,gc=ec.length;while((~ac&&(fc=++fc%gc)!==ac)||(!~ac&&++fc<gc)){var hc=w.getItemLabel(ec[fc]);if(hc&&hc.charAt(0).toLowerCase()===dc){wa(ec[fc]);return false;}}}}});h.subscribe('FriendEditLists/unfriend',rb);h.subscribe('DynamicFriendListEducation/dialogOpen',function(){na=true;});h.subscribe('DynamicFriendListEducation/dialogClosed',function(){na=false;pb();});},initContent:function(ub){o.appendContent(document.body,ub);eb(ub);(function(){if(!ga){ga=ub;ea&&o.setContent(ea.getContent(),[ga,ha]);l.show(ga);g.listen(ga,'click',sb);fa&&lb(ia);}else{o.remove(ub);ub=null;}}).defer();},initNux:function(ub){if(ha)return;ha=ub;ea&&o.setContent(ea.getContent(),[ga,ha]);},show:function(ub){mb(ub);},hide:function(ub){ub===false?rb():pb();},setActiveNode:function(ub){fa&&rb();ia=ub;ja=g.listen(ub,'mouseleave',function(){ia=null;ja&&ja.remove();});},setCloseListener:function(ub,vb){m.set(ub,'flfcloselistener',vb);if(ia!=ub)m.set(ub,'flfcloselistenertimeout',tb.curry(ub).defer(oa));},setCloseListenerTimeout:function(ub){oa=ub;}};function ta(ub){ba.firefox()&&va(ub).blur();w.inform('select',{menu:ua(ub),item:ub});}function ua(ub){if(l.hasClass(ub,'uiMenuContainer'))return ub;return x.byClass(ub,'uiMenu');}function va(ub){return p.find(ub,'a.itemAnchor');}function wa(ub){if(ub&&za(ub)){w._removeSelected(ea.getContent());l.addClass(ub,'selected');va(ub).focus();}}function xa(ub){return x.byClass(ub,'uiMenuItem');}function ya(ub){if(document.activeElement){var vb=xa(document.activeElement);return ub.indexOf(vb);}return -1;}function za(ub){return !l.hasClass(ub,'disabled')&&z.get(ub,'display')!=='none'&&z.get(x.byClass(ub,'uiMenu'),'display')!=='none';}function ab(){return w.getItems(ea.getContent()).filter(za);}function bb(){clearTimeout(la);}function cb(ub){for(var vb=0;vb<ra.length;vb++)if(l.hasClass(ub,ra[vb]))return false;return true;}function db(){if(ia){if(cb(ia)){l.removeClass(ia,"_52nd");if(l.hasClass(ia,'uiButton')||l.hasClass(ia,"_42fu"))l.removeClass(ia,'selected');}if(m.get(ia,'flfcloselistener')){var ub=ia;m.set(ia,'flfcloselistenertimeout',tb.curry(ub).defer(oa));}}fa=false;kb();ia=null;}function eb(ub){var vb=p.scry(ub,'[tabindex="0"]');vb.forEach(function(wb){wb.tabIndex='-1';});vb[0]&&(vb[0].tabIndex='0');}function fb(ub){if(p.isNodeOfType(ub,'label')&&l.hasClass(ub,'uiButton'))ub=j.getInputElement(ub);return ub;}function gb(ub){return m.get(fb(ub),'profileid');}function hb(ub){return m.get(fb(ub),'memorialized')==='true';}function ib(ub){return m.get(fb(ub),'cansuggestfriends')==='true';}function jb(ub){return m.get(fb(ub),'unref');}function kb(){ja&&ja.remove();ja=null;ma&&t.unsubscribe(ma);ma=null;la&&clearTimeout(la);la=null;}function lb(ub){var vb=gb(ub),wb=hb(ub),xb=ib(ub),yb=m.get(ub,'flloc'),zb=jb(ub);q.init(ga,vb,yb,wb,xb,zb);l.conditionClass(ga,'followButtonFlyout',l.hasClass(ub,'profileFollowButton'));l.conditionClass(ga,'friendButtonFlyout',l.hasClass(ub,'FriendRequestFriends')||l.hasClass(ub,'FriendRequestIncoming')||l.hasClass(ub,'FriendRequestOutgoing'));l.conditionClass(ga,'likeButtonFlyout',l.hasClass(ub,'profileLikeButton'));var ac=p.scry(ga,'div.uiScrollableArea')[0];ac&&y.poke(ac);var bc=aa.find(ga)[0];bc&&bc.focus();}function mb(ub){if(!ea||fa)return;ea.setContext(ub);ea.setCausalElement(ub);ub.setAttribute('aria-expanded','true');if(cb(ub)){l.addClass(ub,"_52nd");if(l.hasClass(ub,'uiButton')||l.hasClass(ub,"_42fu"))l.addClass(ub,'selected');}ea.show();ia=ub;fa=true;var vb=null;if(ga){vb='show';lb(ub);}else{vb='init_show';new i().setURI('/ajax/friends/lists/flyout_content.php').setStatusElement(ea.getContent()).send();}kb();ja=g.listen(ub,'mouseleave',pb);ma=t.subscribe('show',nb);if(m.get(ub,'flfcloselistener'))clearTimeout(m.remove(ub,'flfcloselistenertimeout'));var wb=gb(ub);r.getFriend(wb,function(xb){if(xb.status==r.ARE_FRIENDS)new i().setURI('/ajax/friends/lists/flyout_log.php').setData({target_id:gb(ub),unref:jb(ub),action:vb}).send();if(!ha)return;if(xb.status==r.OUTGOING_REQUEST){l.show(ha);i.bootstrap('/ajax/friends/lists/nux_flyout.php',null,true);}else l.hide(ha);});}function nb(ub,vb){if(!(vb instanceof k)||!p.contains(ia,vb.getContext()))pb();}function ob(ub){ia=ub;ka=mb.curry(ub).defer(pa);ja=g.listen(ub,'mouseleave',function(){clearTimeout(ka);ia=null;ja&&ja.remove();});}function pb(){la=rb.defer(150);}function qb(){var ub=n.getCurrent(),vb=ub&&ub.getBody();return !!(vb&&p.scry(vb,'.friendListDialogTourCarousel')[0]);}function rb(){if(na||qb())return;qa=false;ba.ie()<8&&document.documentElement.focus();if(ea){ea.hide();var ub=ea.getCausalElement();ub&&ub.setAttribute('aria-expanded','false');}}function sb(event){var ub=x.byTag(event.getTarget(),'a');if(ub&&l.hasClass(ub,'FriendListActionItem'))pb();}function tb(ub){var vb=m.remove(ub,'flfcloselistener');vb&&vb();}e.exports=a.FriendListFlyoutController||sa;});
__d("AddFriendButton",["Event","Animation","Arbiter","AsyncRequest","AsyncResponse","collectDataAttributes","CSS","DOMQuery","FriendListFlyoutController","FriendStatus","ge","goURI","Style","SubscribeButton","URI","XPubcontentChainedSuggestionsControllerURIBuilder"],function(a,b,c,d,e,f){var g=b('Event'),h=b('Animation'),i=b('Arbiter'),j=b('AsyncRequest'),k=b('AsyncResponse'),l=b('collectDataAttributes'),m=b('CSS'),n=b('DOMQuery'),o=b('FriendListFlyoutController'),p=b('FriendStatus'),q=b('ge'),r=b('goURI'),s=b('Style'),t=b('SubscribeButton'),u=b('URI'),v=b('XPubcontentChainedSuggestionsControllerURIBuilder'),w={ERROR_ALREADY_ADDED:1431005,init:function(x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia){var ja=x.id,ka=null,la=n.scry(x,'.addButton')[0],ma=n.scry(x,'.addFriendText')[0],na=n.scry(x,'.outgoingButton')[0],oa=n.scry(x,'.incomingButton')[0],pa=n.scry(x,'.friendButton')[0];function qa(wa,xa,ya){var za=new u(la.getAttribute('ajaxify')),ab=l(x,['ft','gt']);new j().setURI(ca).setData({to_friend:y,action:wa,how_found:aa,ref_param:ba,link_data:ab,outgoing_id:na.id,xids:za.getQueryData().xids,logging_location:da,no_flyout_on_click:ea,ego_log_data:fa,http_referer:ha}).setErrorHandler(xa).setServerDialogCancelHandler(ya).setRelativeTo(na).send();if(ia&&wa==='add_friend'){var bb=(new v()).getURI();new j().setURI(bb).send();}i.inform(t.SUBSCRIBED,{profile_id:y.toString()});}function ra(wa,xa){if(ma){m.hide(ma);}else if(la)m.hide(la);na&&m.hide(na);oa&&m.hide(oa);pa&&m.hide(pa);if(wa)m.show(wa);if('Outgoing'==xa&&ka!=xa&&ga)new h(wa).from('backgroundColor','#FFF8CC').to('backgroundColor','transparent').from('borderColor','#FFE222').to('borderColor',s.get(wa,'borderLeftColor')).duration(2000).go();ka&&m.removeClass(x,'fStatus'+ka);ka=xa;m.addClass(x,'fStatus'+xa);}function sa(wa){if(m.hasClass(wa,'enableFriendListFlyout')){o.show(wa);}else o.hide();}var ta=i.subscribe('FriendRequest/change',function(wa,xa){va();if(xa.uid!=y)return;switch(xa.status){case p.ARE_FRIENDS:return ra(pa,'Friends');case p.INCOMING_REQUEST:return ra(oa,'Incoming');case p.OUTGOING_REQUEST:return ra(na,'Outgoing');case p.CAN_REQUEST:return ra(ma?ma:la,'Requestable');}}),ua;if(z)ua=i.subscribe('FriendRequest/confirm',function(wa,xa){va();xa.uid==y&&r(z);});la&&g.listen(la,'click',function(){i.inform('FriendRequest/sending',{uid:y});if(ea){o.setActiveNode(na);}else sa(na);qa("add_friend",function(wa){var xa=wa.error==w.ERROR_ALREADY_ADDED?'FriendRequest/sent':'FriendRequest/sendFail';i.inform(xa,{uid:y});o.hide();k.defaultErrorHandler(wa);},function(wa){i.inform('FriendRequest/sendFail',{uid:y});o.hide();});});function va(){if(q(ja))return;ta&&ta.unsubscribe();ua&&ua.unsubscribe();ta=ua=null;}}};e.exports=w;});
__d("FriendButtonIcon",["Arbiter","FriendStatus","Button","arrayContains"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('FriendStatus'),i=b('Button'),j=b('arrayContains');e.exports={register:function(k,l,m){g.subscribe('FriendListMembershipChange',function(n,o){if(o.uid==m){var p=j(o.lists,h.CLOSE_FRIENDS),q=j(o.lists,h.ACQUAINTANCES);if(p&&!q){i.setIcon(k,l.close);}else if(q&&!p){i.setIcon(k,l.acquaintance);}else i.setIcon(k,l.friend);}});}};});